---
title: "Outcome Measures Per Block"
output: html_document
date: "2023-05-01"
---


```{r global-options, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
```

```{r loading libraries, include=FALSE}
# This code chunk loads various libraries necessary to complete the data analysis and produce graphics
library(tidyverse)
library(stringr)
library(ez)
library(cowplot)
library(viridis)
library(viridisLite)
library("readxl")
library("ggcorrplot")
library(dplyr)
library(ltm)
library(plotrix)
library("viridis")
library("paletteer")
library(ggpubr)
library(rstatix)
```

```{r reading data, include=FALSE}
#This data chunk loads and tidies up the data

#This loads the data file as the variable "data"
data <- read.csv('/Users/yasminebassil/Desktop/Data/averaged_results.csv')
# Tidying up the data
names(data)[1] <- 'index'
names(data)[2] <- 'Participant'
names(data)[3] <- 'Block_num'
names(data)[4] <- 'Total_Time'
names(data)[5] <- 'Orientation_Time'
names(data)[6] <- 'Navigation_Time'
names(data)[7] <- 'Distance'
names(data)[8] <- 'Speed'
names(data)[9] <- 'Mean_Dwell'
names(data)[10] <- 'Var_X'
names(data)[11] <- 'Var_Y'
names(data)[12] <- 'Var_Z'
names(data)[13] <- 'Teleportations'
data <- data[ -c(1) ]
data$Block_num <- as.factor(data$Block_num)
sapply(data, class)
data
```

# Total Time

## Plot
```{r ct}
#Data.summary for Total_Time
data.summary <- data %>%
  group_by(Block_num) %>%
  summarise(
    se = std.error(Total_Time),
    Total_Time = mean(Total_Time)
  )
#Total_time by Block_num
p_ct <- ggplot(data, aes(x=Block_num, y=Total_Time, color=Participant))+
  geom_line(data, mapping = aes(x= Block_num, y = Total_Time, group = Participant, color = Participant), alpha = .5)+
  scale_color_viridis(option = "plasma", discrete = TRUE)+
  geom_point(data, mapping = aes(x= Block_num, y = Total_Time, group = Participant),color = 'white', size = 3)+
  geom_point(data, mapping = aes(x= Block_num, y = Total_Time, group = Participant, color = Participant),alpha = .5)+
  geom_line(data.summary, mapping = aes(x= Block_num, y = Total_Time, group = 1), size = 1.5, color = '#242526')+
  stat_summary(fun.args = list(mean_se), 
                geom="crossbar", 
                width=0.2,
                color="#242526") +
  labs(color= "Participant", y="Total Time (s)", x="")+
  scale_x_discrete(labels = c( "Block 1","Block 2","Block 3"))+
  ylim(0,1000)+
  theme_classic()+
  theme(axis.line = element_line(linewidth = .5, colour = "#242526"))+
  theme(axis.ticks = element_line(linewidth = .2, colour = "#242526"))+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(legend.position = "none")+
  theme(axis.text.x = element_text(size=16))+
  theme(axis.text.y = element_text(size=16))+
  theme(axis.title.y = element_text(size=16))
p_ct
```

## Stats

Summary stats of the data:

```{r}
data %>%
  group_by(Block_num) %>%
  get_summary_stats(Total_Time, type = "mean_sd")
```

Visualizing the data:

```{r}
bxp <- ggboxplot(data, x = "Block_num", y = "Total_Time", add = "point")
bxp
```

Looking at outliers and if they're extreme:

```{r}
data %>%
  group_by(Block_num) %>%
  identify_outliers(Total_Time)
```

1 extreme outlier, but we will keep in the analysis for now.

Checking normality assumption: 

```{r}
data %>%
  group_by(Block_num) %>%
  shapiro_test(Total_Time)
```

```{r}
ggqqplot(data, "Total_Time", facet.by = "Block_num")
```
```{r}
ct.aov <- anova_test(data = data, dv = Total_Time, wid = Participant, within = Block_num)
get_anova_table(ct.aov)
```

```{r}
ct.pwc <- data %>%
  pairwise_t_test(
    Total_Time ~ Block_num, paired = TRUE,
    p.adjust.method = "bonferroni"
    )
ct.pwc
```

# Orientation Time

## Plot

```{r orict}
#Data.summary for Orientation_Time
data.summary <- data %>%
  group_by(Block_num) %>%
  summarise(
    se = std.error(Orientation_Time),
    Orientation_Time = mean(Orientation_Time)
  )
#Orientation Time by Block_num
p_orict <- ggplot(data, aes(x=Block_num, y=Orientation_Time, color=Participant))+
  geom_line(data, mapping = aes(x= Block_num, y = Orientation_Time, group = Participant, color = Participant), alpha = .5)+
  scale_color_viridis(option = "plasma", discrete = TRUE)+
  geom_point(data, mapping = aes(x= Block_num, y = Orientation_Time, group = Participant),color = 'white', size = 3)+
  geom_point(data, mapping = aes(x= Block_num, y = Orientation_Time, group = Participant, color = Participant),alpha = .5)+
  geom_line(data.summary, mapping = aes(x= Block_num, y = Orientation_Time, group = 1), size = 1.5, color = '#242526')+
  stat_summary(fun.args = list(mean_se), 
                geom="crossbar", 
                width=0.2, 
                color="#242526") +
  labs(color= "Participant", y="Orientation Time (s)", x="")+
  scale_x_discrete(labels = c( "Block 1","Block 2","Block 3"))+
  ylim(0,100)+
  theme_classic()+
  theme(axis.line = element_line(linewidth = .5, colour = "#242526"))+
  theme(axis.ticks = element_line(linewidth = .2, colour = "#242526"))+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(legend.position = "none")+
  theme(axis.text.x = element_text(size=16))+
  theme(axis.text.y = element_text(size=16))+
  theme(axis.title.y = element_text(size=16))
p_orict
```

## Stats

Summary stats of the data:

```{r}
data %>%
  group_by(Block_num) %>%
  get_summary_stats(Orientation_Time, type = "mean_sd")
```

Visualizing the data:

```{r}
bxp <- ggboxplot(data, x = "Block_num", y = "Orientation_Time", add = "point")
bxp
```

Looking at outliers and if they're extreme:

```{r}
data %>%
  group_by(Block_num) %>%
  identify_outliers(Orientation_Time)
```

2 extreme outliers, but we will keep in the analysis for now.

Checking normality assumption: 

```{r}
data %>%
  group_by(Block_num) %>%
  shapiro_test(Orientation_Time)
```

```{r}
ggqqplot(data, "Orientation_Time", facet.by = "Block_num")
```

```{r}
ctori.aov <- anova_test(data = data, dv = Orientation_Time, wid = Participant, within = Block_num)
get_anova_table(ctori.aov)
```

```{r}
ctori.pwc <- data %>%
  pairwise_t_test(
    Orientation_Time ~ Block_num, paired = TRUE,
    p.adjust.method = "bonferroni"
    )
ctori.pwc
```
# Navigation Time

## Plot

```{r navct}
#Data.summary for Navigation_Time
data.summary <- data %>%
  group_by(Block_num) %>%
  summarise(
    se = std.error(Navigation_Time),
    Navigation_Time = mean(Navigation_Time)
  )
#Navigation Time by Block_num
p_navct <- ggplot(data, aes(x=Block_num, y=Navigation_Time, color=Participant))+
  geom_line(data, mapping = aes(x= Block_num, y = Navigation_Time, group = Participant, color = Participant), alpha = .5)+
  scale_color_viridis(option = "plasma", discrete = TRUE)+
  geom_point(data, mapping = aes(x= Block_num, y = Navigation_Time, group = Participant),color = 'white', size = 3)+
  geom_point(data, mapping = aes(x= Block_num, y = Navigation_Time, group = Participant, color = Participant),alpha = .5)+
  geom_line(data.summary, mapping = aes(x= Block_num, y = Navigation_Time, group = 1), size = 1.5, color = '#242526')+
  stat_summary(fun.args = list(mean_se), 
                geom="crossbar", 
                width=0.2, 
                color="#242526") +
  labs(color= "Participant", y="Navigation Time (s)", x="")+
  scale_x_discrete(labels = c( "Block 1","Block 2","Block 3"))+
  ylim(0,1000)+
  theme_classic()+
  theme(axis.line = element_line(linewidth = .5, colour = "#242526"))+
  theme(axis.ticks = element_line(linewidth = .2, colour = "#242526"))+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(legend.position = "none")+
  theme(axis.text.x = element_text(size=16))+
  theme(axis.text.y = element_text(size=16))+
  theme(axis.title.y = element_text(size=16))
p_navct
```

## Stats

Summary stats of the data:

```{r}
data %>%
  group_by(Block_num) %>%
  get_summary_stats(Navigation_Time, type = "mean_sd")
```

Visualizing the data:

```{r}
bxp <- ggboxplot(data, x = "Block_num", y = "Navigation_Time", add = "point")
bxp
```

Looking at outliers and if they're extreme:

```{r}
data %>%
  group_by(Block_num) %>%
  identify_outliers(Navigation_Time)
```

1 extreme outliers, but we will keep in the analysis for now.

Checking normality assumption: 

```{r}
data %>%
  group_by(Block_num) %>%
  shapiro_test(Navigation_Time)
```

```{r}
ggqqplot(data, "Navigation_Time", facet.by = "Block_num")
```

```{r}
ctnav.aov <- anova_test(data = data, dv = Navigation_Time, wid = Participant, within = Block_num)
get_anova_table(ctnav.aov)
```

```{r}
ctnav.pwc <- data %>%
  pairwise_t_test(
    Navigation_Time ~ Block_num, paired = TRUE,
    p.adjust.method = "bonferroni"
    )
ctnav.pwc
```
# Distance

## Plot

```{r dt}
#Data.summary for Distance
data.summary <- data %>%
  group_by(Block_num) %>%
  summarise(
    se = std.error(Distance),
    Distance = mean(Distance)
  )
#Distance by Block_num
p_dt <- ggplot(data, aes(x=Block_num, y=Distance, color=Participant))+
  geom_line(data, mapping = aes(x= Block_num, y = Distance, group = Participant, color = Participant), alpha = .5)+
  scale_color_viridis(option = "plasma", discrete = TRUE)+
  geom_point(data, mapping = aes(x= Block_num, y = Distance, group = Participant),color = 'white', size = 3)+
  geom_point(data, mapping = aes(x= Block_num, y = Distance, group = Participant, color = Participant),alpha = .5)+
  geom_line(data.summary, mapping = aes(x= Block_num, y = Distance, group = 1), size = 1.5, color = '#242526')+
  stat_summary(fun.args = list(mean_se), 
                geom="crossbar", 
                width=0.2, 
                color="#242526") +
  labs(color= "Participant", y="Distance Traveled (VR Units)", x="")+
  scale_x_discrete(labels = c( "Block 1","Block 2","Block 3"))+
  ylim(0,5000)+
  theme_classic()+
  theme(axis.line = element_line(linewidth = .5, colour = "#242526"))+
  theme(axis.ticks = element_line(linewidth = .2, colour = "#242526"))+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(legend.position = "none")+
  theme(axis.text.x = element_text(size=16))+
  theme(axis.text.y = element_text(size=16))+
  theme(axis.title.y = element_text(size=16))
p_dt
```

## Stats

Summary stats of the data:

```{r}
data %>%
  group_by(Block_num) %>%
  get_summary_stats(Distance, type = "mean_sd")
```

Visualizing the data:

```{r}
bxp <- ggboxplot(data, x = "Block_num", y = "Distance", add = "point")
bxp
```

Looking at outliers and if they're extreme:

```{r}
data %>%
  group_by(Block_num) %>%
  identify_outliers(Distance)
```

No extreme outliers.

Checking normality assumption: 

```{r}
data %>%
  group_by(Block_num) %>%
  shapiro_test(Distance)
```

```{r}
ggqqplot(data, "Distance", facet.by = "Block_num")
```

```{r}
dt.aov <- anova_test(data = data, dv = Distance, wid = Participant, within = Block_num)
get_anova_table(dt.aov)
```

```{r}
dt.pwc <- data %>%
  pairwise_t_test(
    Distance ~ Block_num, paired = TRUE,
    p.adjust.method = "bonferroni"
    )
dt.pwc
```

# Speed

## Plot

```{r speed}
#Data.summary for Speed
data.summary <- data %>%
  group_by(Block_num) %>%
  summarise(
    se = std.error(Speed),
    Speed = mean(Speed)
  )
#Speed by Block_num
p_speed <- ggplot(data, aes(x=Block_num, y=Speed, color=Participant))+
  geom_line(data, mapping = aes(x= Block_num, y = Speed, group = Participant, color = Participant), alpha = .5)+
  scale_color_viridis(option = "plasma", discrete = TRUE)+
  geom_point(data, mapping = aes(x= Block_num, y = Speed, group = Participant),color = 'white', size = 3)+
  geom_point(data, mapping = aes(x= Block_num, y = Speed, group = Participant, color = Participant),alpha = .5)+
  geom_line(data.summary, mapping = aes(x= Block_num, y = Speed, group = 1), size = 1.5, color = '#242526')+
  stat_summary(fun.args = list(mean_se), 
                geom="crossbar", 
                width=0.2, 
                color="#242526") +
  labs(color= "Participant", y="Speed (VR Unit/s)", x="")+
  scale_x_discrete(labels = c( "Block 1","Block 2","Block 3"))+
  ylim(0,23)+
  theme_classic()+
  theme(axis.line = element_line(linewidth = .5, colour = "#242526"))+
  theme(axis.ticks = element_line(linewidth = .2, colour = "#242526"))+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(legend.position = "none")+
  theme(axis.text.x = element_text(size=16))+
  theme(axis.text.y = element_text(size=16))+
  theme(axis.title.y = element_text(size=16))
p_speed
```

## Stats

Summary stats of the data:

```{r}
data %>%
  group_by(Block_num) %>%
  get_summary_stats(Speed, type = "mean_sd")
```

Visualizing the data:

```{r}
bxp <- ggboxplot(data, x = "Block_num", y = "Speed", add = "point")
bxp
```

Looking at outliers and if they're extreme:

```{r}
data %>%
  group_by(Block_num) %>%
  identify_outliers(Speed)
```

No extreme outliers.

Checking normality assumption: 

```{r}
data %>%
  group_by(Block_num) %>%
  shapiro_test(Speed)
```

```{r}
ggqqplot(data, "Speed", facet.by = "Block_num")
```

```{r}
speed.aov <- anova_test(data = data, dv = Speed, wid = Participant, within = Block_num)
get_anova_table(speed.aov)
```

```{r}
speed.pwc <- data %>%
  pairwise_t_test(
    Speed ~ Block_num, paired = TRUE,
    p.adjust.method = "bonferroni"
    )
speed.pwc
```

# Dwell Time

## Plot

```{r dwell}
#Data.summary for Mean_Dwell
data.summary <- data %>%
  group_by(Block_num) %>%
  summarise(
    se = std.error(Mean_Dwell),
    Mean_Dwell = mean(Mean_Dwell)
  )
#Mean_Dwell by Block_num
p_dwell <- ggplot(data, aes(x=Block_num, y=Mean_Dwell, color=Participant))+
  geom_line(data, mapping = aes(x= Block_num, y = Mean_Dwell, group = Participant, color = Participant), alpha = .5)+
  scale_color_viridis(option = "plasma", discrete = TRUE)+
  geom_point(data, mapping = aes(x= Block_num, y = Mean_Dwell, group = Participant),color = 'white', size = 3)+
  geom_point(data, mapping = aes(x= Block_num, y = Mean_Dwell, group = Participant, color = Participant),alpha = .5)+
  geom_line(data.summary, mapping = aes(x= Block_num, y = Mean_Dwell, group = 1), size = 1.5, color = '#242526')+
  stat_summary(fun.args = list(mean_se), 
                geom="crossbar", 
                width=0.2, 
                color="#242526") +
  labs(color= "Participant", y="Mean Dwell Time (s)", x="")+
  scale_x_discrete(labels = c( "Block 1","Block 2","Block 3"))+
  ylim(0,3)+
  theme_classic()+
  theme(axis.line = element_line(linewidth = .5, colour = "#242526"))+
  theme(axis.ticks = element_line(linewidth = .2, colour = "#242526"))+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(legend.position = "none")+
  theme(axis.text.x = element_text(size=16))+
  theme(axis.text.y = element_text(size=16))+
  theme(axis.title.y = element_text(size=16))
p_dwell
``` 

## Stats

Summary stats of the data:

```{r}
data %>%
  group_by(Block_num) %>%
  get_summary_stats(Mean_Dwell, type = "mean_sd")
```

Visualizing the data:

```{r}
bxp <- ggboxplot(data, x = "Block_num", y = "Mean_Dwell", add = "point")
bxp
```

Looking at outliers and if they're extreme:

```{r}
data %>%
  group_by(Block_num) %>%
  identify_outliers(Mean_Dwell)
```

No extreme outliers.

Checking normality assumption: 

```{r}
data %>%
  group_by(Block_num) %>%
  shapiro_test(Mean_Dwell)
```

```{r}
ggqqplot(data, "Mean_Dwell", facet.by = "Block_num")
```

```{r}
dwell.aov <- anova_test(data = data, dv = Mean_Dwell, wid = Participant, within = Block_num)
get_anova_table(dwell.aov)
```

```{r}
dwell.pwc <- data %>%
  pairwise_t_test(
    Mean_Dwell ~ Block_num, paired = TRUE,
    p.adjust.method = "bonferroni"
    )
dwell.pwc
```
# Teleportations 

## Plot

```{r teleport}
#Data.summary for Teleportations
data.summary <- data %>%
  group_by(Block_num) %>%
  summarise(
    se = std.error(Teleportations),
    Teleportations = mean(Teleportations)
  )
#Teleportations by Block_num
p_teleport <- ggplot(data, aes(x=Block_num, y=Teleportations, color=Participant))+
  geom_line(data, mapping = aes(x= Block_num, y = Teleportations, group = Participant, color = Participant), alpha = .5)+
  scale_color_viridis(option = "plasma", discrete = TRUE)+
  geom_point(data, mapping = aes(x= Block_num, y = Teleportations, group = Participant),color = 'white', size = 3)+
  geom_point(data, mapping = aes(x= Block_num, y = Teleportations, group = Participant, color = Participant),alpha = .5)+
  geom_line(data.summary, mapping = aes(x= Block_num, y = Teleportations, group = 1), size = 1.5, color = '#242526')+
  stat_summary(fun.args = list(mean_se), 
                geom="crossbar", 
                width=0.2, 
                color="#242526") +
  labs(color= "Participant", y="Teleportations (count)", x="")+
  scale_x_discrete(labels = c( "Block 1","Block 2","Block 3"))+
  ylim(0,700)+
  theme_classic()+
  theme(axis.line = element_line(linewidth = .5, colour = "#242526"))+
  theme(axis.ticks = element_line(linewidth = .2, colour = "#242526"))+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(legend.position = "none")+
  theme(axis.text.x = element_text(size=16))+
  theme(axis.text.y = element_text(size=16))+
  theme(axis.title.y = element_text(size=16))
p_teleport
```

## Stats

Summary stats of the data:

```{r}
data %>%
  group_by(Block_num) %>%
  get_summary_stats(Teleportations, type = "mean_sd")
```

Visualizing the data:

```{r}
bxp <- ggboxplot(data, x = "Block_num", y = "Teleportations", add = "point")
bxp
```

Looking at outliers and if they're extreme:

```{r}
data %>%
  group_by(Block_num) %>%
  identify_outliers(Teleportations)
```

No extreme outliers.

Checking normality assumption: 

```{r}
data %>%
  group_by(Block_num) %>%
  shapiro_test(Teleportations)
```

```{r}
ggqqplot(data, "Teleportations", facet.by = "Block_num")
```

```{r}
teleport.aov <- anova_test(data = data, dv = Teleportations, wid = Participant, within = Block_num)
get_anova_table(teleport.aov)
```

```{r}
teleport.pwc <- data %>%
  pairwise_t_test(
    Teleportations ~ Block_num, paired = TRUE,
    p.adjust.method = "bonferroni"
    )
teleport.pwc
```

# P Value Correction for Comparisons So Far

```{r}
# Combining all t-test outputs into dataframe
test_output <- rbind(ct.pwc, ctori.pwc, ctnav.pwc, dt.pwc, speed.pwc, dwell.pwc, teleport.pwc)
test_output$p.adj_final <- p.adjust(test_output$p.adj, method = "bonferroni", n = nrow(test_output))
```

# Variance X

## Plot

```{r varx}
#Data.summary for Var_X
data.summary <- data %>%
  group_by(Block_num) %>%
  summarise(
    se = std.error(Var_X),
    Var_X = mean(Var_X)
  )
#Var_X by Block_num
p_varx <- ggplot(data, aes(x=Block_num, y=Var_X, color=Participant))+
  geom_line(data, mapping = aes(x= Block_num, y = Var_X, group = Participant, color = Participant), alpha = .5)+
  scale_color_viridis(option = "plasma", discrete = TRUE)+
  geom_point(data, mapping = aes(x= Block_num, y = Var_X, group = Participant),color = 'white', size = 3)+
  geom_point(data, mapping = aes(x= Block_num, y = Var_X, group = Participant, color = Participant),alpha = .5)+
  geom_line(data.summary, mapping = aes(x= Block_num, y = Var_X, group = 1), size = 1.5, color = '#242526')+
  stat_summary(fun.args = list(mean_se), 
                geom="crossbar", 
                width=0.2, 
                color="#242526") +
  labs(color= "Participant", y="X Euler Angle Variation (degrees/s)", x="")+
  scale_x_discrete(labels = c( "Block 1","Block 2","Block 3"))+
  ylim(0,20)+
  theme_classic()+
  theme(axis.line = element_line(linewidth = .5, colour = "#242526"))+
  theme(axis.ticks = element_line(linewidth = .2, colour = "#242526"))+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(legend.position = "none")+
  theme(axis.text.x = element_text(size=16))+
  theme(axis.text.y = element_text(size=16))+
  theme(axis.title.y = element_text(size=16))
p_varx
```


## Stats

Summary stats of the data:

```{r}
data %>%
  group_by(Block_num) %>%
  get_summary_stats(Var_X, type = "mean_sd")
```

Visualizing the data:

```{r}
bxp <- ggboxplot(data, x = "Block_num", y = "Var_X", add = "point")
bxp
```

Looking at outliers and if they're extreme:

```{r}
data %>%
  group_by(Block_num) %>%
  identify_outliers(Var_X)
```

No extreme outliers.

Checking normality assumption: 

```{r}
data %>%
  group_by(Block_num) %>%
  shapiro_test(Var_X)
```

```{r}
ggqqplot(data, "Var_X", facet.by = "Block_num")
```

```{r}
varx.aov <- anova_test(data = data, dv = Var_X, wid = Participant, within = Block_num)
get_anova_table(varx.aov)
```

```{r}
varx.pwc <- data %>%
  pairwise_t_test(
    Var_X ~ Block_num, paired = TRUE,
    p.adjust.method = "bonferroni"
    )
varx.pwc
```

# Variance Y

## Plot

```{r vary}
#Data.summary for Var_Y
data.summary <- data %>%
  group_by(Block_num) %>%
  summarise(
    se = std.error(Var_Y),
    Var_Y = mean(Var_Y)
  )
#Var_Y by Block_num
p_vary <- ggplot(data, aes(x=Block_num, y=Var_Y, color=Participant))+
  geom_line(data, mapping = aes(x= Block_num, y = Var_Y, group = Participant, color = Participant), alpha = .5)+
  scale_color_viridis(option = "plasma", discrete = TRUE)+
  geom_point(data, mapping = aes(x= Block_num, y = Var_Y, group = Participant),color = 'white', size = 3)+
  geom_point(data, mapping = aes(x= Block_num, y = Var_Y, group = Participant, color = Participant),alpha = .5)+
  geom_line(data.summary, mapping = aes(x= Block_num, y = Var_Y, group = 1), size = 1.5, color = '#242526')+
  stat_summary(fun.args = list(mean_se), 
                geom="crossbar", 
                width=0.2, 
                color="#242526") +
  labs(color= "Participant", y="Y Euler Angle Variation (degrees/s)", x="")+
  scale_x_discrete(labels = c( "Block 1","Block 2","Block 3"))+
  ylim(0,130)+
  theme_classic()+
  theme(axis.line = element_line(linewidth = .5, colour = "#242526"))+
  theme(axis.ticks = element_line(linewidth = .2, colour = "#242526"))+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(legend.position = "none")+
  theme(axis.text.x = element_text(size=16))+
  theme(axis.text.y = element_text(size=16))+
  theme(axis.title.y = element_text(size=16))
p_vary
```

## Stats

Summary stats of the data:

```{r}
data %>%
  group_by(Block_num) %>%
  get_summary_stats(Var_Y, type = "mean_sd")
```

Visualizing the data:

```{r}
bxp <- ggboxplot(data, x = "Block_num", y = "Var_Y", add = "point")
bxp
```

Looking at outliers and if they're extreme:

```{r}
data %>%
  group_by(Block_num) %>%
  identify_outliers(Var_Y)
```

No extreme outliers.

Checking normality assumption: 

```{r}
data %>%
  group_by(Block_num) %>%
  shapiro_test(Var_Y)
```

```{r}
ggqqplot(data, "Var_Y", facet.by = "Block_num")
```

```{r}
vary.aov <- anova_test(data = data, dv = Var_Y, wid = Participant, within = Block_num)
get_anova_table(vary.aov)
```

```{r}
vary.pwc <- data %>%
  pairwise_t_test(
    Var_Y ~ Block_num, paired = TRUE,
    p.adjust.method = "bonferroni"
    )
vary.pwc
```

# Variance Z

## Plot

```{r varz}
#Data.summary for Var_Z
data.summary <- data %>%
  group_by(Block_num) %>%
  summarise(
    se = std.error(Var_Z),
    Var_Z = mean(Var_Z)
  )
#Var_Z by Block_num
p_varz <- ggplot(data, aes(x=Block_num, y=Var_Z, color=Participant))+
  geom_line(data, mapping = aes(x= Block_num, y = Var_Z, group = Participant, color = Participant), alpha = .5)+
  scale_color_viridis(option = "plasma", discrete = TRUE)+
  geom_point(data, mapping = aes(x= Block_num, y = Var_Z, group = Participant),color = 'white', size = 3)+
  geom_point(data, mapping = aes(x= Block_num, y = Var_Z, group = Participant, color = Participant),alpha = .5)+
  geom_line(data.summary, mapping = aes(x= Block_num, y = Var_Z, group = 1), size = 1.5, color = '#242526')+
  stat_summary(fun.args = list(mean_se), 
                geom="crossbar", 
                width=0.2, 
                color="#242526") +
  labs(color= "Participant", y="Z Euler Angle Variation (degrees/s)", x="")+
  scale_x_discrete(labels = c( "Block 1","Block 2","Block 3"))+
  ylim(0,10)+
  theme_classic()+
  theme(axis.line = element_line(linewidth = .5, colour = "#242526"))+
  theme(axis.ticks = element_line(linewidth = .2, colour = "#242526"))+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(legend.position = "none")+
  theme(axis.text.x = element_text(size=16))+
  theme(axis.text.y = element_text(size=16))+
  theme(axis.title.y = element_text(size=16))
p_varz
```

## Stats

Summary stats of the data:

```{r}
data %>%
  group_by(Block_num) %>%
  get_summary_stats(Var_Z, type = "mean_sd")
```

Visualizing the data:

```{r}
bxp <- ggboxplot(data, x = "Block_num", y = "Var_Z", add = "point")
bxp
```

Looking at outliers and if they're extreme:

```{r}
data %>%
  group_by(Block_num) %>%
  identify_outliers(Var_Z)
```

No extreme outliers.

Checking normality assumption: 

```{r}
data %>%
  group_by(Block_num) %>%
  shapiro_test(Var_Z)
```

```{r}
ggqqplot(data, "Var_Z", facet.by = "Block_num")
```

```{r}
varz.aov <- anova_test(data = data, dv = Var_Z, wid = Participant, within = Block_num)
get_anova_table(varz.aov)
```

```{r}
varz.pwc <- data %>%
  pairwise_t_test(
    Var_Z ~ Block_num, paired = TRUE,
    p.adjust.method = "bonferroni"
    )
varz.pwc
```

# P Value Correction for Head Motion Comparisons

```{r}
# Combining all t-test outputs into dataframe
headmotion_test_output <- rbind(varx.pwc, vary.pwc, varz.pwc)
headmotion_test_output$p.adj_final <- p.adjust(headmotion_test_output$p.adj, method = "bonferroni", n = nrow(headmotion_test_output))
```

# Saving CSVs

```{r}

```
